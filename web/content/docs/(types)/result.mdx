---
title: Result
description: A type for operations that can succeed or fail
---

import { Callout } from "fumadocs-ui/components/callout";

# Result Type

The `Result<T, E>` type represents an operation that can either succeed with a value or fail with an error.

## Overview

```ts
type Result<T, E> =
  | { ok: true; value: T }
  | { ok: false; error: E };
```

## Creating Results

### Success

```ts
import { success } from "@deessejs/functions";

const result = success({ id: 1, name: "Alice" });
// Result<{ id: number; name: string }, never>
```

### Failure

```ts
import { failure, exception } from "@deessejs/functions";

const error = exception({
  name: "NotFound",
  message: "User not found",
});

const result = failure(error);
// Result<never, Exception>
```

## Using Results

### Type Narrowing

```ts
const result = await api.getUser({ id: 1 });

if (result.ok) {
  // TypeScript knows this is a success
  console.log(result.value.name); // string
} else {
  // TypeScript knows this is a failure
  console.error(result.error.message); // string
}
```

### Pattern Matching

```ts
function handleResult<T, E>(result: Result<T, E>): string {
  if (result.ok) {
    return `Success: ${JSON.stringify(result.value)}`;
  } else {
    return `Error: ${result.error.message}`;
  }
}
```

## Utility Functions

### map

Transform the success value:

```ts
import { success } from "@deessejs/functions";

const result = success({ id: 1, name: "Alice" });

const mapped = result.map(user => user.name);
// Result<string, Exception>
```

### mapError

Transform the error:

```ts
import { failure, exception } from "@deessejs/functions";

const result = failure(
  exception({ name: "NotFound", message: "Not found" })
);

const mapped = result.mapError(err => ({
  ...err,
  message: `Error: ${err.message}`,
}));
```

### chain

Chain operations that return Results:

```ts
const result = await api.getUser({ id: 1 });

const emailResult = result.chain(async (user) => {
  return await api.getEmail({ userId: user.id });
});
```

### unwrap

Get the value or throw:

```ts
const result = await api.getUser({ id: 1 });

try {
  const user = result.unwrap();
  console.log(user);
} catch (error) {
  console.error("Failed to get user");
}
```

### unwrapOr

Get the value or a default:

```ts
const result = await api.getUser({ id: 1 });

const user = result.unwrapOr({ id: 0, name: "Unknown" });
```

### unwrapOrElse

Get the value or compute a default:

```ts
const result = await api.getUser({ id: 1 });

const user = result.unwrapOrElse(() => ({
  id: 0,
  name: "Unknown",
}));
```

## Examples

### API Response

```ts
const getUser = t.query({
  args: z.object({ id: z.number() }),
  handler: async (ctx, args) => {
    const user = await ctx.db.users.find(args.id);

    if (!user) {
      return failure(
        exception({ name: "NotFound", message: "User not found" })
      );
    }

    return success(user);
  },
});

// Usage
const result = await api.getUser({ id: 1 });

if (result.ok) {
  console.log("User:", result.value);
} else {
  console.error("Error:", result.error.message);
}
```

### Validation

```ts
function validateEmail(email: string): Result<string, Exception> {
  if (email.includes("@")) {
    return success(email);
  }

  return failure(
    exception({
      name: "InvalidEmail",
      message: "Email must contain @",
    })
  );
}

const result = validateEmail("test@example.com");

if (result.ok) {
  console.log("Valid email:", result.value);
} else {
  console.error("Invalid email:", result.error.message);
}
```

### Chaining Operations

```ts
const result = await api.getUser({ id: 1 })
  .map(user => user.id)
  .chain(async userId => {
    return await api.getPosts({ userId });
  });

if (result.ok) {
  console.log("Posts:", result.value);
}
```

## Best Practices

<Callout type="warn">
Always check `result.ok` before accessing `result.value` or `result.error`.
</Callout>

```ts
// Good
if (result.ok) {
  console.log(result.value);
} else {
  console.error(result.error);
}

// Bad - may throw at runtime
console.log(result.value); // Error if result.ok is false
```

<Callout type="tip">
Use `result.map()` for transformations and `result.chain()` for async operations.
</Callout>

```ts
// Good - use map for simple transformations
const name = result.map(user => user.name);

// Good - use chain for async operations
const posts = result.chain(async user => {
  return await api.getPosts({ userId: user.id });
});
```

## Related Types

- [AsyncResult](/docs/types/async-result) - For async operations
- [Maybe](/docs/types/maybe) - For optional values
- [Outcome](/docs/types/outcome) - For complex failure scenarios
